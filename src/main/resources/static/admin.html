<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <!-- ‚úÖ META VIEWPORT CR√çTICO - ESTO ES LO M√ÅS IMPORTANTE -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
    <title>Panel de Administraci√≥n - Robot Educativo</title>
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <header class="header">
        <h1>üîß Panel de Administraci√≥n</h1>
        <p>Gesti√≥n del sistema Robot Educativo</p>
      </header>

      <div class="admin-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
          <div class="user-info">
            <div>
              <strong class="user-nombre"></strong>
              <br />
              <small class="user-username"></small>
            </div>
          </div>

          <h3>Men√∫</h3>
          <ul class="sidebar-menu">
            <li>
              <a href="#dashboard" class="menu-link active" data-section="dashboard">
                üìä Dashboard
              </a>
            </li>
            <li>
              <a href="#administradores" class="menu-link" data-section="administradores">
                üë• Administradores
              </a>
            </li>
            <li>
              <a href="#bitacora" class="menu-link" data-section="bitacora">
                üìã Bit√°cora
              </a>
            </li>
            <li>
              <a href="#pistas" class="menu-link" data-section="pistas">
                üéÆ Gesti√≥n de Pistas
              </a>
            </li>
            <li>
              <a href="configurar.html"> ‚öôÔ∏è Configurar Pistas </a>
            </li>
            <li>
              <a href="index.html"> üè† Volver al Juego </a>
            </li>
            <li>
              <a href="#" id="logout-btn" style="color: #f44336">
                üö™ Cerrar Sesi√≥n
              </a>
            </li>
          </ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
          <!-- Dashboard Section -->
          <section id="dashboard-section" class="section active">
            <h2>Dashboard General</h2>

            <div class="stats-grid">
              <div class="stat-card">
                <h3 id="totalVisitas">0</h3>
                <p>Total Visitas</p>
              </div>
              <div class="stat-card">
                <h3 id="totalExitos">0</h3>
                <p>Completaciones Exitosas</p>
              </div>
              <div class="stat-card">
                <h3 id="totalFallos">0</h3>
                <p>Completaciones Fallidas</p>
              </div>
              <div class="stat-card">
                <h3 id="porcentajeExito">0%</h3>
                <p>Tasa de √âxito</p>
              </div>
              <div class="stat-card">
                <h3 id="totalPistas">0</h3>
                <p>Pistas Activas</p>
              </div>
              <div class="stat-card">
                <h3 id="totalAdmins">0</h3>
                <p>Administradores</p>
              </div>
            </div>

            <h3>Estad√≠sticas por Pista</h3>
            <div class="table-container">
              <table id="tablaPistasStats">
                <thead>
                  <tr>
                    <th>Pista</th>
                    <th>Visitas</th>
                    <th>√âxitos</th>
                    <th>Fallos</th>
                    <th>% √âxito</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="5">Cargando...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>

          <!-- Administradores Section -->
          <section id="administradores-section" class="section">
            <h2>Gesti√≥n de Administradores</h2>

            <button class="btn-primary" onclick="mostrarModalNuevoAdmin()">
              ‚ûï Nuevo Administrador
            </button>

            <div class="table-container">
              <table id="tablaAdministradores">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Username</th>
                    <th>Nombre</th>
                    <th>Email</th>
                    <th>Estado</th>
                    <th>Acciones</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="6">Cargando...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>

          <!-- Bit√°cora Section -->
          <section id="bitacora-section" class="section">
            <h2>Bit√°cora del Sistema</h2>

            <div class="table-container">
              <table id="tablaBitacora">
                <thead>
                  <tr>
                    <th>Fecha/Hora</th>
                    <th>Usuario</th>
                    <th>Acci√≥n</th>
                    <th>Descripci√≥n</th>
                    <th>IP</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="5">Cargando...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>

          <!-- Pistas Section -->
          <section id="pistas-section" class="section">
            <h2>Gesti√≥n de Pistas</h2>

            <div style="margin-bottom: 20px">
              <button class="btn-primary" onclick="exportarTodasLasPistas()">
                üì§ Exportar Todas las Pistas
              </button>
              <button class="btn-primary" onclick="mostrarModalImportar()">
                üì• Importar Pistas
              </button>
            </div>

            <div class="table-container">
              <table id="tablaPistas">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Creado Por</th>
                    <th>Fecha Creaci√≥n</th>
                    <th>Estado</th>
                    <th>Acciones</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="6">Cargando...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>
        </main>
      </div>

      <!-- Footer -->
      <footer class="footer">
        <p>Universidad Mariano G√°lvez - Desarrollo Web - Juan Manuel Marroquin</p>
      </footer>
    </div>

    <!-- Modal para nuevo/editar administrador -->
    <div id="modalAdmin" class="modal">
      <div class="modal-content">
        <div class="modal-form">
          <h2 id="modalAdminTitulo">Nuevo Administrador</h2>
          <form id="formAdmin">
            <input type="hidden" id="adminId" />

            <div class="form-group">
              <label>Username</label>
              <input type="text" id="adminUsername" required />
            </div>

            <div class="form-group">
              <label>Nombre Completo</label>
              <input type="text" id="adminNombre" required />
            </div>

            <div class="form-group">
              <label>Email</label>
              <input type="email" id="adminEmail" required />
            </div>

            <div class="form-group" id="passwordGroup">
              <label>Contrase√±a</label>
              <input type="password" id="adminPassword" required />
            </div>

            <button type="submit" class="btn-primary">Guardar</button>
            <button type="button" class="btn-secondary" onclick="cerrarModalAdmin()">
              Cancelar
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- Modal para importar pistas -->
    <div id="modalImportar" class="modal">
      <div class="modal-content">
        <div class="modal-form">
          <h2>Importar Pistas</h2>
          <form id="formImportar">
            <div class="form-group">
              <label>Selecciona archivo JSON</label>
              <input type="file" id="archivoImportar" accept=".json" required />
            </div>

            <button type="submit" class="btn-primary">Importar</button>
            <button type="button" class="btn-secondary" onclick="cerrarModalImportar()">
              Cancelar
            </button>
          </form>
        </div>
      </div>
    </div>

    <script src="js/auth.js"></script>
    <script src="js/admin.js"></script>
  </body>
</html>